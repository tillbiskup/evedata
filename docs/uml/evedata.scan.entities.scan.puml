@startuml
'https://plantuml.com/class-diagram

class Scan {
    repeatcount : integer
    description : string
    comment : string
    savefilename : string
    confirmsave : boolean
    monitoroptions : string[]
    startevent : Event
    redoevents : Event[]
    breakevents : Event[]
    stopevents : Event[]
    pauseconditions : PauseCondition[]
    scanmodules : AbstractScanModule[]
}
Scan *-- "n" AbstractScanModule
Scan *-- "n" PauseCondition
Scan *-- "n" Event

note bottom of PauseCondition: See separate\nevent module.

File *- Scan
note left of File: See separate\nfile module.

class AbstractScanModule {
    id : integer
    name : string
    parent : integer
    appended : integer
    nested : integer
}
AbstractScanModule <|-- ScanModule
AbstractScanModule <|-- SnapshotModule

class Controller {
    parameter : Parameter[]
    name : string
}
Controller *-- "n" Parameter

note bottom of Controller
    Why is "Controller"
    not named "Plugin"?
    What is the difference
    between the two?
end note

class IntervalChannel {
    triggerinterval : float
    stoppedby : string
}

class Parameter {
    value : string
    name : string
}

class Positioning {
    axis_id : string
    channel_id : string
    normalize_id : string
    plugin : Controller
}
Positioning *-- Controller

class ScanModule {
    valuecount : integer
    settletime : float
    triggerdelay : float
    triggerconfirmaxis : boolean
    triggerconfirmchannel : boolean
    triggerevents : Event[]
    redoevents : Event[]
    breakevents : Event[]
    prescans : PreScan[]
    axes : Axis[]
    channels : Channel[]
    postscans : PostScan[]
    positionings : Positioning[]
    plots : Plot[]
}
ScanModule *-- "n" Event
ScanModule *-- "n" PreScan
ScanModule *-- "n" Axis
ScanModule *-- "n" Channel
ScanModule *-- "n" PostScan
ScanModule *-- "n" Positioning
ScanModule *-- "n" Plot

note bottom of Plot: See separate\nplot module.
note bottom of Event: See separate\nevent module.

class PreScan {
    id : string
    value : typevalue
}

class PostScan {
    id : string
    value : typevalue
    reset_originalvalue : boolean
}

class SnapshotModule {
}

class Axis {
    id : string
    stepfunction : StepFunction
    positionmode : PositionMode
    startstopstep : StartStopStep
    stepfilename : string
    plugin : Controller
    positionlist : string
    range : StepFunctionRange
}
Axis *-- StepFunction
Axis *-- PositionMode
Axis *-- StartStopStep
Axis *-- Controller
Axis *-- StepFunctionRange

enum PositionMode {
    relative
    absolute
}

class Channel {
    id : string
    normalize_id : string
    redoevents : Event[]
    deferredtrigger : boolean
}
Channel <|-- StandardChannel
Channel <|-- IntervalChannel
Channel *-- "n" Event

class StandardChannel {
    averagecount : integer
    maxdeviation : float
    minimum : float
    maxattempts : integer
    sendreadyevent : boolean
}

class StartStopStep {
    start : typevalue
    stop : typevalue
    stepwidth : typevalue
    ismainaxis : boolean
}

enum StepFunction {
    Add
    Multiply
    File
    Plugin
    Positionlist
    Range
}

class StepFunctionRange {
    expression : string
    positionlist : string
}

@enduml