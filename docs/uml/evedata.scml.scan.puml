@startuml
'https://plantuml.com/class-diagram

class Scan {
    repeatcount : integer
    comment : string
    savefilename : string
    confirmsave : boolean
    saveplugin : Controller
    monitoroptions : string[]
    startevent : Event
    redoevents : Event[]
    breakevents : Event[]
    stopevents : Event[]
    pauseconditions : PauseCondition[]
    scanmodules : ScanModule[]
}
Scan *-- Controller
Scan *-- "n" ScanModule
Scan *-- "n" PauseCondition
Scan *-- "n" Event

note bottom of PauseCondition: See separate\nevent module.

File *- Scan
note left of File: See separate\nfile module.

class ScanModule {
    name : string
    xpos : integer
    ypos : integer
    parent : integer
    nested : integer
    appended : integer
    id : integer
}
ScanModule <|-- ClassicScanModule
ScanModule <|-- StaticAxisSnapshot
ScanModule <|-- StaticChannelSnapshot
ScanModule <|-- DynamicAxisSnapshot
ScanModule <|-- DynamicChannelSnapshot

class Controller {
    parameter : Parameter[]
    name : string
}
Controller *-- "n" Parameter

class IntervalChannel {
    triggerinterval : float
    stoppedby : string
}

class Parameter {
    value : string
    name : string
}

class Positioning {
    axis_id : string
    channel_id : string
    normalize_id : string
    plugin : Controller
}
Positioning *-- Controller

class ClassicScanModule {
    valuecount : integer
    settletime : float
    triggerdelay : float
    triggerconfirmaxis : boolean
    triggerconfirmchannel : boolean
    triggerevents : Event[]
    redoevents : Event[]
    breakevents : Event[]
    prescans : PreScan[]
    axes : Axis[]
    channels : Channel[]
    postscans : PostScan[]
    positionings : Positioning[]
    plots : Plot[]
}
ClassicScanModule *-- "n" Event
ClassicScanModule *-- "n" PreScan
ClassicScanModule *-- "n" Axis
ClassicScanModule *-- "n" Channel
ClassicScanModule *-- "n" PostScan
ClassicScanModule *-- "n" Positioning
ClassicScanModule *-- "n" Plot

note bottom of Plot: See separate\nplot module.
note bottom of Event: See separate\nevent module.

class PreScan {
    id : string
    value : typevalue
}

class PostScan {
    id : string
    value : typevalue
    reset_originalvalue : boolean
}

class DynamicAxisSnapshot {
}

class DynamicChannelSnapshot {
}

class StaticAxisSnapshot {
    axes : Axis[]
}
StaticAxisSnapshot *-- "n" Axis

class StaticChannelSnapshot {
    channels : Channel[]
}
StaticChannelSnapshot *-- "n" Channel

class Axis {
    axis_id : string
    stepfunction : StepFunction
    positionmode : PositionMode
    startstopstep : StartStopStep
    stepfilename : string
    plugin : Controller
    positionlist : string
    range : StepFunctionRange
}
Axis *-- StepFunction
Axis *-- PositionMode
Axis *-- StartStopStep
Axis *-- Controller
Axis *-- StepFunctionRange

enum PositionMode {
    relative = relative
    absolute = absolute
}

class Channel {
    channelid : string
    normalize_id : string
    redoevents : Event[]
    deferredtrigger : boolean
}
Channel <|-- StandardChannel
Channel <|-- IntervalChannel
Channel *-- "n" Event

class StandardChannel {
    averagecount : integer
    maxdeviation : float
    minimum : float
    maxattempts : integer
    sendreadyevent : boolean
}

class StartStopStep {
    start : typevalue
    stop : typevalue
    stepwidth : typevalue
    ismainaxis : boolean
}

enum StepFunction {
    Add = Add
    Multiply = Multiply
    File = File
    Plugin = Plugin
    Positionlist = Positionlist
    Range = Range
}

class StepFunctionRange {
    expression : string
    positionlist : string
}

@enduml